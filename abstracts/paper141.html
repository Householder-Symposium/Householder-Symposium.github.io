---
layout: abstract
absnum: 141
---
{% raw %}

<div data-nosnippet
    style="display:none"
>

\(\newcommand{\footnotename}{footnote}\)

\(\def \LWRfootnote {1}\)

\(\newcommand {\footnote }[2][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\newcommand {\footnotemark }[1][\LWRfootnote ]{{}^{\mathrm {#1}}}\)

\(\let \LWRorighspace \hspace \)

\(\renewcommand {\hspace }{\ifstar \LWRorighspace \LWRorighspace }\)

\(\newcommand {\mathnormal }[1]{{#1}}\)

\(\newcommand \ensuremath [1]{#1}\)

\(\newcommand {\LWRframebox }[2][]{\fbox {#2}} \newcommand {\framebox }[1][]{\LWRframebox } \)

\(\newcommand {\setlength }[2]{}\)

\(\newcommand {\addtolength }[2]{}\)

\(\newcommand {\setcounter }[2]{}\)

\(\newcommand {\addtocounter }[2]{}\)

\(\newcommand {\arabic }[1]{}\)

\(\newcommand {\number }[1]{}\)

\(\newcommand {\noalign }[1]{\text {#1}\notag \\}\)

\(\newcommand {\cline }[1]{}\)

\(\newcommand {\directlua }[1]{\text {(directlua)}}\)

\(\newcommand {\luatexdirectlua }[1]{\text {(directlua)}}\)

\(\newcommand {\protect }{}\)

\(\def \LWRabsorbnumber #1 {}\)

\(\def \LWRabsorbquotenumber &quot;#1 {}\)

\(\newcommand {\LWRabsorboption }[1][]{}\)

\(\newcommand {\LWRabsorbtwooptions }[1][]{\LWRabsorboption }\)

\(\def \mathchar {\ifnextchar &quot;\LWRabsorbquotenumber \LWRabsorbnumber }\)

\(\def \mathcode #1={\mathchar }\)

\(\let \delcode \mathcode \)

\(\let \delimiter \mathchar \)

\(\def \oe {\unicode {x0153}}\)

\(\def \OE {\unicode {x0152}}\)

\(\def \ae {\unicode {x00E6}}\)

\(\def \AE {\unicode {x00C6}}\)

\(\def \aa {\unicode {x00E5}}\)

\(\def \AA {\unicode {x00C5}}\)

\(\def \o {\unicode {x00F8}}\)

\(\def \O {\unicode {x00D8}}\)

\(\def \l {\unicode {x0142}}\)

\(\def \L {\unicode {x0141}}\)

\(\def \ss {\unicode {x00DF}}\)

\(\def \SS {\unicode {x1E9E}}\)

\(\def \dag {\unicode {x2020}}\)

\(\def \ddag {\unicode {x2021}}\)

\(\def \P {\unicode {x00B6}}\)

\(\def \copyright {\unicode {x00A9}}\)

\(\def \pounds {\unicode {x00A3}}\)

\(\let \LWRref \ref \)

\(\renewcommand {\ref }{\ifstar \LWRref \LWRref }\)

\( \newcommand {\multicolumn }[3]{#3}\)

\(\require {textcomp}\)

\(\newcommand {\intertext }[1]{\text {#1}\notag \\}\)

\(\let \Hat \hat \)

\(\let \Check \check \)

\(\let \Tilde \tilde \)

\(\let \Acute \acute \)

\(\let \Grave \grave \)

\(\let \Dot \dot \)

\(\let \Ddot \ddot \)

\(\let \Breve \breve \)

\(\let \Bar \bar \)

\(\let \Vec \vec \)

\(\newcommand {\RR }{{\mathbb {R}}}\)

\(\newcommand {\CC }{{\mathbb {C}}}\)

\(\newcommand {\PP }{{\mathbb {P}}}\)

\(\newcommand {\KK }{{\mathbb {K}}}\)

\(\newcommand {\cB }{{\cal {B}}}\)

\(\newcommand {\cF }{{\cal {F}}}\)

\(\newcommand {\cM }{{\cal {M}}}\)

\(\newcommand {\cS }{{\cal {S}}}\)

\(\newcommand {\cU }{{\cal {U}}}\)

\(\newcommand {\cW }{{\cal {W}}}\)

\(\def \bw {{\mathbf w}}\)

</div>

<a id="paper-autopage-1"></a>
<div class="center">

<h2>
Adaptive data-driven reduced-order models of port-Hamiltonian dynamical systems for nonlinear inverse scattering applications
</h2>
</div>
<div class="center">

<p>
<span class="underline">Mikhail Zaslavskiy</span>, Vladimir Druskin, Shari Moskow
</p>
</div>
<div class="center">

<p>
Abstract
</p>
</div>
<!--
...... section Problem formulation ......
-->
<h4 id="autosec-5"><span class="sectionnumber">1&#x2003;</span>Problem formulation</h4>
<a id="paper-autopage-5"></a>


<p>
The inverse scattering problem formulated for the Schrödinger operators arises in various fields, including quantum mechanics, radars, viscoelasticity, Biot problems, remote sensing, geophysical, and medical imaging. The goal of imaging is to find
medium properties in the domain using near-field measured data. The model based nonlinear optimization which is the method of choice for the solution of the inverse problems can be unreliable and particularly expensive for such problems. Data
driven nonlinear transforms can be an opening, however it was recently shown that the ReLU networks are intractable for reliable solution of the inverse problems in continuum using conventional digital computers. In the present work, following the
success of data-driven reduced-order models (ROMs) developed in recent years, we propose a robust direct method for solving inverse scattering problems for the Schrödinger equation. Our approach is based on a Lippmann-Schwinger algorithm with
a crucial component composed of adaptive data-driven ROMs in the frequency domain and eﬀicient learning the internal solutions. Below we discuss the details of the algorithms as well as some bottlenecks.
</p>

<p>
We consider first-order formulation of frequency-domain wave problem in lossy medium
</p>

<span class="hidden"> \(\seteqnumber{0}{}{0}\)</span>


<!--


                                                                                                              1
                                                                                                      ∇·v+      ∇(ln(σ)) · v + ru + iωu = f                                                                                                         (1)
                                                                                                              2
                                                                                                                    1
                                                                                                              ∇u − ∇(ln(σ)))u + iωv = 0                                                                                                             (2)
                                                                                                                    2

-->


<p>

\begin{eqnarray}
\nabla \cdot v+\frac {1}{2}\nabla (\ln (\sigma ))\cdot v+ru+i\omega u=f\\ \nabla u-\frac {1}{2}\nabla (\ln (\sigma )))u+i\omega v=0
\end{eqnarray}

</p>

<p>
in a bounded domain \(\Omega \) for \(m\) sources \(f\in \RR ^{\infty \times m}\). Here \(u,v\in \CC ^{\infty \times m}\) with columns being solutions for the corresponding sources. We assume that the measured data is given by \(f^Tu\)
where columns of \(f\) and \(u\) are multiplied with respect to \(L_2\) nner product \((g;h)_{L_2}=\int _\Omega {ghdV}\). After spatial discretization we obtain MIMO port-Hamiltonian LTI dynamical system [2] in the frequency-domain
</p>

<span class="hidden"> \(\seteqnumber{0}{}{2}\)</span>

<!--


                                                                                                                (A + P )w + iωw = F                                                                                      (3)--><a id="LTI"></a><!--

-->

<p>

\begin{equation}
\label {LTI} (A+P)w+i\omega w=F
\end{equation}

</p>

<p>
with skew-symmetric matrix \(A=-A^T\in \RR ^{N\times N}\), symmetric matrix \(P=P^T\in \RR ^{N\times N}\), \(F\in \RR ^{N\times m}\). The measured data is given by \(D(\omega )=F^Tw\). We note that the obtained system (<a
href="paper.html#LTI">3</a>) is symmetric with respect to indefinite (pseudo-)inner product \((x;y)_J=x^HJx\) where \(^H\) denotes Hermitian conjugate and
</p>

<span class="hidden"> \(\seteqnumber{0}{}{3}\)</span>

<!--

                                                                                                                         (                )
                                                                                                                             I        0
                                                                                                                    J=                                                                                                                              (4)
                                                                                                                             0       −I

-->

<p>

\begin{equation}
J=\begin{pmatrix}I&amp;0\\ 0&amp;-I \end {pmatrix}
\end{equation}

</p>

<p>
In the inverse scattering problem in lossy medium the goal is to recover unknown damping term \(r\) and reflectivity \(\ln (\sigma )\) under known data \(D(\omega ))\). In the LTI system (<a href="paper.html#LTI">3</a>) the discrete
counterparts of both unknowns compose matrix \(P\).
</p>

<p>
Lippmann-Schwinger approach has been proven to be a powerful tool for solving inverse scattering problem [3]. It can be formulated in terms of integral equation involving solution \((u;v)\) for unknown medium as well as solution \((u^0;v^0)\) for
background with some a priori known parameters (say, \(r=\ln (\sigma )=0\)):
</p>

<span class="hidden"> \(\seteqnumber{0}{}{4}\)</span>


<!--



                                                                                                                ∇ · v 0 + iωu0 = f                                                                                                                  (5)
                                                                                                                 ∇u + iωv = 0.
                                                                                                                    0            0
                                                                                                                                                                                                                                                    (6)

-->


<p>

\begin{eqnarray}
\nabla \cdot v^0+i\omega u^0=f\\ \nabla u^0+i\omega v^0=0.
\end{eqnarray}

</p>

<p>
After spatial discretization we obtain
</p>

<span class="hidden"> \(\seteqnumber{0}{}{6}\)</span>

<!--


                                                                                                                   Aw0 + iωw0 = F                                                                                   (7)--><a id="LTIbckg"></a><!--

-->

<p>

\begin{equation}
\label {LTIbckg} Aw^0+i\omega w^0=F
\end{equation}

</p>

<p>
with background data given by \(D^0(\omega )=F^Tw^0\). The discrete counterpart of Lippmann-Schwinger equation can be formulated then as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{7}\)</span>

<!--


                                                                                                         (w0 )H (ω)JP w(ω) = D0 (ω) − D(ω).                                                                             (8)--><a id="lseq"></a><!--

-->

<p>

\begin{equation}
\label {lseq} (w^0)^H(\omega )JPw(\omega )=D^0(\omega )-D(\omega ).
\end{equation}

</p>

<p>
This is a system of nonlinear equations with respect to unknown parameter matrix \(P\) because \(w(\omega )\) itself depends on \(P\). Tradional way to linearize this problem is so-called Born approximation, i.e. \(w(\omega )\approx w^0(\omega
)\), however it is known to work for small \(P\) only. Below we will show how to exploit the measured data \(D(\omega )\) to construct a better approximant of \(w(\omega )\) for further linearizarion of Lippmann-Schwinger equation (<a
href="paper.html#lseq">8</a>).
</p>
<!--
...... section Adaptive data-driven ROMs ......
-->
<h4 id="autosec-6"><span class="sectionnumber">2&#x2003;</span>Adaptive data-driven ROMs</h4>
<a id="paper-autopage-6"></a>


<p>
Consider Galerkin projection of (<a href="paper.html#LTI">3</a>) onto the rational Krylov subspace spanned on columns of \(V=\{w_1=w(\omega _1),\ldots , w_n=w(\omega _n)\}\) with respect to \((;)_J\) inner product. Here \(w(\omega
_i),~i=1,\ldots ,n\) are solutions of (<a href="paper.html#LTI">3</a>) for \(\omega =\omega _1,\ldots ,\omega _n\), respectively. The projected system (<a href="paper.html#LTI">3</a>) has a form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{8}\)</span>

<!--


                                                                                                                 SW + iωMW = B                                                                                    (9)--><a id="eq:gal"></a><!--

-->

<p>

\begin{equation}
\label {eq:gal} \cS \cW +i\omega \cM \cW =\cB
\end{equation}

</p>

<p>
where \(w\approx V\cW \), \(\cS \) is Hermitian indefinite stiffness matrix with block elements
</p>

<span class="hidden"> \(\seteqnumber{0}{}{9}\)</span>

<!--


                                                                                                   Spq = wqH J(A + P )wp ∈ Cm×m , q, p = 1, . . . , n                                                                                            (10)

-->

<p>

\begin{equation}
\cS _{pq}=w^H_qJ(A+P)w_p\in \CC ^{m\times m},~q,p=1,\ldots , n
\end{equation}

</p>

<p>
, \(\cM \) is Hermitian indefinite mass matrix with block elements
</p>

<span class="hidden"> \(\seteqnumber{0}{}{10}\)</span>

<!--


                                                                                                      Mpq = wqH Jwp ∈ Cm×m , q, p = 1, . . . , n                                                                                                 (11)

-->

<p>

\begin{equation}
\cM _{pq}=w^H_qJw_p\in \CC ^{m\times m},~q,p=1,\ldots , n
\end{equation}

</p>

<p>
and blocks of \(\cB \) are given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{11}\)</span>

<!--


                                                                                                  Bq = wqH F = D̄q = D̄(ωq ) ∈ Cm×m q = 1, . . . , n.                                                                                            (12)

-->

<p>

\begin{equation}
\cB _q=w^H_qF=\bar {D}_q=\bar {D}(\omega _q)\in \CC ^{m\times m}~q=1,\ldots , n.
\end{equation}

</p>

<p>
The measured data in Galerkin formulation is given by
</p>

<span class="hidden"> \(\seteqnumber{0}{}{12}\)</span>

<!--


                                                                                                                      F = BH W                                                                                 (13)--><a id="romdata"></a><!--

-->

<p>

\begin{equation}
\label {romdata}\cF =\cB ^H\cW
\end{equation}

</p>

<p>
We note that although internal solutions \(w_p,~p=1,\ldots n\) are not accessible because \(P\) in (<a href="paper.html#LTI">3</a>) is unknown, blocks of mass and stiffness matrices can still be obtained directly from the data via Loewner
framework:
</p>

<span class="hidden"> \(\seteqnumber{0}{}{13}\)</span>

<!--


                                                                                                                             Dp − D̄q
                                                                                                                 wqH Jwp =                                                                                     (14)--><a id="massmtr"></a><!--
                                                                                                                             iωq + iωp

-->

<p>

\begin{equation}
\label {massmtr} w^H_qJw_p=\frac {D_p-\bar {D}_q}{i\omega _q+i\omega _p}
\end{equation}

</p>

<p>
and
</p>

<span class="hidden"> \(\seteqnumber{0}{}{14}\)</span>

<!--


                                                                                                                              ωq D̄q + Dp ωp
                                                                                                          wqH J(A + P )wp =                                                                                    (15)--><a id="stifmtr"></a><!--
                                                                                                                                  ωq + ωp

-->

<p>

\begin{equation}
\label {stifmtr} w^H_qJ(A+P)w_p=\frac {\omega _q\bar {D}_q+D_p\omega _p}{\omega _q+\omega _p}
\end{equation}

</p>

<p>
(with derivatives of the data \(D\) and \(\omega D\) for mass and stiffness matrices when \(\omega _p=-\omega _q\), respectively).
</p>

<p>
To improve the eﬀiciency of the constructed ROM we employ greedy algorithms for adaptive choice of interpolation frequencies \(\omega _1,\ldots ,\omega _n\) which is similar to AAA algorithm [4]:
</p>
<div class="theoremcontents">

<ul class="list" style="list-style-type:none">


<li>
<p>
<span class="listmarker"><span class="theoremlabel">Algorithm 1 </span></span> <a id="adpol"></a>
</p>

<ul class="enumerate" style="list-style-type:none">


<li>
<p>
<span class="listmarker">1.</span> For the given frequency range of interest \(\omega \in [\omega _{min},\omega _{max}]\) set \(\omega _1=\sqrt {\omega _{min}\omega _{max}}\), \(n=1\)
</p>
</li>
<li>


<p>
<span class="listmarker">2.</span> Compute matrix pencil \((\cS ;\cM )\) via Loewner approach (<a href="paper.html#massmtr">14</a>) and (<a href="paper.html#stifmtr">15</a>) for interpolation points \(\omega _1,\ldots ,\omega
_n\)
</p>


</li>
<li>


<p>
<span class="listmarker">3.</span> Compute ROM data \(\cF \) for \(\omega \in [\omega _{min},\omega _{max}]\) via (<a href="paper.html#eq:gal">9</a>) and (<a href="paper.html#romdata">13</a>)
</p>


</li>
<li>


<p>
<span class="listmarker">4.</span> Evaluate error \(\cF -D\) and set \(\omega _{n+1}=argmax(\|\cF -D\|)\) If there are several frequencies for which the maximum is attained, it suﬀices to select any one of the corresponding frequencies.
</p>


</li>
<li>


<p>
<span class="listmarker">5.</span> Set \(n=n+1\).
</p>


</li>
<li>


<p>
<span class="listmarker">6.</span> Repeat steps 2–5 until convergence to the desired accuracy.
</p>
</li>
</ul>

</li>

</ul>

</div>

<p>
We note that the obtained ROM is not structure-preserving, i.e. it may not inherit passivity and even stability of the original full-scale system (<a href="paper.html#LTI">3</a>).
</p>
<!--
...... section Lippmann-Schwinger-Lanczos approach ......
-->
<h4 id="autosec-8"><span class="sectionnumber">3&#x2003;</span>Lippmann-Schwinger-Lanczos approach</h4>
<a id="paper-autopage-8"></a>


<p>
In this section we show how to exploit the constructed data-driven ROMs to construct an approximant of internal solution \(w\) in (<a href="paper.html#lseq">8</a>). Similar to the unknown medium, we can construct background matrix pencil
\((\cS ^0;\cM ^0)\) for the selected set of frequencies \(\omega _1,\ldots ,\omega _n\). Note that it can be performed in model-driven way because all the internal solutions for known background \(P=0\) are accessible. Background counterpart
of ROM (<a href="paper.html#eq:gal">9</a>) has a form
</p>

<span class="hidden"> \(\seteqnumber{0}{}{15}\)</span>

<!--


                                                                                                                     S 0 W 0 + iωM0 W 0 = B0                                                                     (16)--><a id="eq:galbckg"></a><!--

-->

<p>

\begin{equation}
\label {eq:galbckg} \cS ^0\cW ^0+i\omega \cM ^0\cW ^0=\cB ^0
\end{equation}

</p>

<p>
where \(w^0\approx V^0\cW ^0\) and \(V^0=\{w^0_1=w^0(\omega _1),\ldots , w^0_n=w^0(\omega _n)\}\). Let’s perform Lanczos orthogonalization for matrix \((\cM )^{-1}\cS \) with respect to indefinite inner product \((;)_{\cM }\) and
starting vector \((\cM )^{-1}\cB /\|(\cM )^{-1}\cB \|_{\cM }\) and do the same for background part \((\cM ^0)^{-1}\cS ^0\) with respect to \((;)_{\cM ^0}\) and starting vector \((\cM ^0)^{-1}\cB ^0/\|(\cM ^0)^{-1}\cB ^0\|\):
</p>

<span class="hidden"> \(\seteqnumber{0}{}{16}\)</span>


<!--



                                                                                                                 (M)−1 SQ = QT, QH MQ = I                                                                                                           (17)
                                                                                                         0 −1
                                                                                                     (M )       S Q = Q T , (Q ) M Q = I.
                                                                                                                 0    0     0   0   0 h   0    0
                                                                                                                                                                                                                                                    (18)

-->


<p>

\begin{eqnarray}
(\cM )^{-1}\cS Q=QT,~Q^H\cM Q=I\\ (\cM ^0)^{-1}\cS ^0 Q^0=Q^0T^0,~(Q^0)^h\cM ^0 Q^0=I.
\end{eqnarray}

</p>

<p>
As has been noted in [1], although \(V\) is totally different from \(V_0\), we have \(VQ\approx V_0Q_0\). It has been explained in that paper for lossless case via drawing an analogy with causal time-domain solutions, however similar reasoning is
applicable for lossy scenario and ROM we developed. Therefore, we can construct an approximant of internal solution as
</p>

<span class="hidden"> \(\seteqnumber{0}{}{18}\)</span>

<!--


                                                                            w ≈ V (S + iωM)−1 B = V Q(T + iωI)−1 E1 |(M)−1 B∥M ≈ V 0 Q0 (T + iωI)−1 E1 |(M)−1 B∥M = w                                                                               (19)

-->

<p>

\begin{equation}
w\approx V(\cS +i\omega \cM )^{-1}\cB =VQ(T+i\omega I)^{-1}E_1|(\cM )^{-1}\cB \|_{\cM }\approx V^0Q^0(T+i\omega I)^{-1}E_1|(\cM )^{-1}\cB \|_{\cM }=\bw
\end{equation}

</p>

<p>
Once plugged in into the Lippmann-Schwinger equation (<a href="paper.html#lseq">8</a>), we obtain a linear equation with respect to \(P\):
</p>

<span class="hidden"> \(\seteqnumber{0}{}{19}\)</span>

<!--


                                                                                                          (w0 )H (ω)JP w(ω) = D0 (ω) − D(ω).                                                                           (20)--><a id="lsleq"></a><!--

-->

<p>

\begin{equation}
\label {lsleq} (w^0)^H(\omega )JP\bw (\omega )=D^0(\omega )-D(\omega ).
\end{equation}

</p>

<p>
We call this algorithm Lippmann–Schwinger–Lanczos to emphasize the crucial component of constructing internal solution that is based Lanczos orthogonalization. There are multiple parts of our approach that need to be addressed to improve its
performance:
</p>
<ul class="itemize" style="list-style-type:none">

<li>
<p>
<span class="listmarker">•</span> Eﬀicient handling of overfitting that results in rank-deficient matrix \(\cM \) and may breakdown Lanczos algorithm
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> Fast and robust solution of (<a href="paper.html#lsleq">20</a>) that is typically underdetermined
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> Data completion approach to handle missing data in square MIMO transfer function \(D(\omega )\)
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> Construction of passive ROMs
</p>

</li>
<li>

<p>
<span class="listmarker">•</span> Convergence estimates
</p>
</li>
</ul>
<!--
...... section References ......
-->
<h4 id="autosec-9">References</h4>
<a id="paper-autopage-9"></a>


<ul class="list" style="list-style-type:none">

<li>
<p>
<span class="listmarker">[1]&#x2003;</span> Justin Baker and Elena Cherkaev and Vladimir Druskin and Shari Moskow and Mikhail Zaslavsky, <i>Regularized Reduced Order Lippman-Schwinger-Lanczos Method for Inverse Scattering Problems
in the Frequency Domain</i>, submitted to Journal of Computational Physics, arXiv preprint arXiv:2311.16367, 2023
</p>

</li>
<li>

<p>
<span class="listmarker">[2]&#x2003;</span> Christopher A. Beattie, Volker Mehrmann, Paul Van Dooren, <i>Robust port-Hamiltonian representations of passive systems</i>, Automatica, 100, 2019: 182–186
</p>

</li>
<li>

<p>
<span class="listmarker">[3]&#x2003;</span> D. Colton and R. Kress, <i>Inverse Acoustic and Electromagnetic Scattering Theory</i>, Springer, Berlin, 2nd ed., 1998.
</p>

</li>
<li>

<p>
<span class="listmarker">[4]&#x2003;</span> Nakatsukasa, Yuji and Sète, Olivier and Trefethen, Lloyd N, <i>The AAA Algorithm for Rational Approximation</i>, SIAM Journal on Scientific Computing, 40 (3), 2018: A1494-A1522
</p>
</li>
</ul>

{% endraw %}
